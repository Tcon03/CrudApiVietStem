<UserControl x:Class="CrudVietSteam.View.UserControls.CityUC"
                         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                         xmlns:local="clr-namespace:CrudVietSteam.View.UserControls"
                         mc:Ignorable="d" 
                         x:Name="root"
                         xmlns:Icon="http://metro.mahapps.com/winfx/xaml/iconpacks"
                         xmlns:viewModel ="clr-namespace:CrudVietSteam.ViewModel"
                         d:DesignHeight="550" d:DesignWidth="600">
    <!--<UserControl.DataContext>
        <viewModel:CityVM/>
    </UserControl.DataContext>-->


    <Grid Margin="6">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>



        <Border Background="White"
                BorderBrush="LightGray" 
                BorderThickness="1"
                Grid.Row="1"
                CornerRadius="20">
            <DataGrid  
                   Margin="10"
                   HeadersVisibility="Column"
                   BorderThickness="0" 
                   Background="Transparent"
                   GridLinesVisibility="None"
                   ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                   ScrollViewer.VerticalScrollBarVisibility="Hidden"
                   Foreground="{DynamicResource TextPrimaryBlack}"
                   AutoGenerateColumns="False"
                   CanUserAddRows="False"
                   IsReadOnly="True"
                   ItemsSource="{Binding Citys,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                   ColumnHeaderStyle="{StaticResource CustomColumnHeaderStyle}"
                   RowStyle="{StaticResource DataGridRowHoverStyle}"
                   CellStyle="{StaticResource CustomDataGridCellStyle}" >


                <DataGrid.Columns>

                    <DataGridTemplateColumn >
                        <!--check box Header Click all Record-->
                        <DataGridTemplateColumn.HeaderTemplate>
                            <DataTemplate>

                                <CheckBox  
                                           IsChecked="{Binding DataContext.IsAllSelected, RelativeSource={RelativeSource AncestorType=DataGrid}, Mode=TwoWay}"
                                           Command="{Binding DataContext.SeletedAllCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                </CheckBox>

                            </DataTemplate>
                        </DataGridTemplateColumn.HeaderTemplate>

                        <!--check box item record-->
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>

                                <CheckBox  
                                    
                                            Command="{Binding DataContext.SeletedItemCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            IsChecked="{Binding IsChecked,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>

                    </DataGridTemplateColumn>

                    <!--display the data from ContestsDTO-->
                    <DataGridTextColumn Header="ID"  
                                        ElementStyle="{StaticResource TextBlockStyleData}"
                                        Binding="{Binding id ,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                        CanUserResize="False"
                                        Width="50">

                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Name" 
                                        ElementStyle="{StaticResource TextBlockStyleData}"
                                        Binding="{Binding name ,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                        Width="*"/>

                    <DataGridTextColumn Header="Type"
                                        ElementStyle="{StaticResource TextBlockStyleData}"
                                        Binding="{Binding type ,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                        Width="*"/>
                    <DataGridTextColumn Header="MTP"
                                        ElementStyle="{StaticResource TextBlockStyleData}"
                                        Binding="{Binding mtp ,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  
                                        Width="*"/>
                    <DataGridTemplateColumn   Width="50"  >
                        <!--Custom Actions-->

                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="⋮"
                                        Click="Button_Click"
                                        Tag="{Binding DataContext, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                        Style="{StaticResource DataGridActionMenuItemStyle}">
                                    <Button.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="Edit" 
                                                     CommandParameter="{Binding}"
                                                     Command="{Binding PlacementTarget.Tag.EditCityCommand,RelativeSource={RelativeSource AncestorType=ContextMenu}}">
                                                <MenuItem.Icon>
                                                    <Icon:PackIconMaterial Kind="Pencil" />
                                                </MenuItem.Icon>
                                            </MenuItem>

                                            <!--Item Delete-->
                                            <MenuItem Header="Delete" Foreground="Red"
                                                         CommandParameter="{Binding}" 
                                                         Command="{Binding PlacementTarget.Tag.DeleteCityCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}">
                                                <MenuItem.Icon>
                                                    <Icon:PackIconMaterial Kind="Delete" Foreground="Red"/>
                                                </MenuItem.Icon>
                                            </MenuItem>
                                        </ContextMenu>
                                    </Button.ContextMenu>
                                    <!--Item Edit-->
                                </Button>

                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <!-- Thêm các cột khác từ ContestsDTO của bạn ở đây -->
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <Grid Grid.Row="2" >

            <TextBlock HorizontalAlignment="Left"
                         FontSize="20"
                         FontWeight="Bold"
                         Margin="10"
                         VerticalAlignment="Bottom">
                  <Run Text="Total Records : "/>
                  <Run Text="{Binding TotalRecords,Mode=OneWay,UpdateSourceTrigger =PropertyChanged}"  />

            </TextBlock>

            <StackPanel  
                         HorizontalAlignment="Right"
                         VerticalAlignment="Bottom"
                         Orientation="Horizontal">
                <Button HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Command="{Binding DeleteAllItem}" 
                        CommandParameter="{Binding ElementName=root}"
                         Content="Delete">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource btnClear}">
                            <!-- Mặc định là ẩn -->
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Setter Property="Margin" Value="0 0 30 0"/>
                            <Setter Property="FontSize" Value="15"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            
                            <Setter Property="Foreground" Value="Black"/>

                            <Style.Triggers>
                                <!-- Khi IsAnyItemSelected là True, thì hiện ra -->
                                <DataTrigger Binding="{Binding IsAnyItemSelected}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button  Command="{Binding PreviousPage}" 
                         CommandParameter="{Binding ElementName=root}"
                         Margin="5"
                         Style="{StaticResource btnIconNext}">
                    <Icon:PackIconMaterial Kind="ChevronLeft" 
                                           Foreground="White"/>
                </Button>
                <TextBlock 
                            FontSize="18"
                            FontWeight="Medium"
                            VerticalAlignment="Center"
                            Margin=" 5">
                      <Run Text="{Binding CurrentPage , Mode=OneWay,UpdateSourceTrigger=PropertyChanged}"/> 
                      <Run Text=" of "/>
                      <Run Text="{Binding TotalPage , Mode=OneWay ,UpdateSourceTrigger=PropertyChanged}"/>
                </TextBlock>
                <Button   Command="{Binding NextPage}"
                          CommandParameter="{Binding ElementName=root}"
                          Style="{StaticResource btnIconNext}"
                          BorderThickness="0">
                    <Icon:PackIconMaterial  Kind="ChevronRight" 
                                            Foreground="White"/>
                </Button>

            </StackPanel>
        </Grid>


    </Grid>

</UserControl>
